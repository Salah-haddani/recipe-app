<nav class="navbar">
  <div class="nav-container">
    <a class="brand" routerLink="/home">
      <span class="brand-text">RecipeApp</span>
    </a>
    <div class="nav-links">
      <a *ngIf="isPublisher()" routerLink="/my-kitchen" class="nav-link">
        <span class="material-icons link-icon">restaurant</span>
        My Kitchen
      </a>
      <button class="logout-button" (click)="logout()">
        <span class="material-icons logout-icon">logout</span>
        Logout
      </button>
    </div>
  </div>
</nav>
<div class="kitchen-header">
  <h1 class="kitchen-title">
    <span class="material-icons link-icon-title">restaurant</span>
    My Kitchen
  </h1>
  <p class="kitchen-subtitle">Create and manage your recipes</p>
</div>

<div class="kitchen-container">
  <!-- My Recipes Section -->
  <div class="recipes-section">
    <div class="section-header">
      <h2 class="section-title">My Recipe Collection</h2>
      <div class="header-actions">
        <button class="kitchen-sort-btn" (click)="toggleSort()">
          <span class="material-icons">sort</span>
          {{ currentSort === "desc" ? "Newest" : "Oldest" }}
        </button>
        <span class="recipe-count"
          >{{ totalRecipes }} recipe{{ totalRecipes !== 1 ? "s" : "" }}</span
        >
      </div>
    </div>

    <div class="recipes-grid" *ngIf="myRecipes.length > 0">
      <div *ngFor="let recipe of myRecipes" class="recipe-item">
        <div class="recipe-item-header">
          <span class="material-icons recipe-icon">restaurant</span>
          <h3 class="recipe-item-title">{{ recipe.title }}</h3>
        </div>
        <div class="recipe-item-actions">
          <button class="edit-button" (click)="editRecipe(recipe)">
            <span class="material-icons">edit</span>
            Edit
          </button>
          <button class="delete-button" (click)="deleteRecipe(recipe._id)">
            <span class="material-icons">delete</span>
            Delete
          </button>
        </div>
      </div>
    </div>

    <div class="kitchen-pagination" *ngIf="totalRecipes > pageSize">
      <button
        class="mini-pag-btn"
        [disabled]="currentPage === 1"
        (click)="changePage(currentPage - 1)"
      >
        <span class="material-icons">navigate_before</span>
      </button>

      <span class="page-indicator">Page {{ currentPage }}</span>

      <button
        class="mini-pag-btn"
        [disabled]="currentPage * pageSize >= totalRecipes"
        (click)="changePage(currentPage + 1)"
      >
        <span class="material-icons">navigate_next</span>
      </button>
    </div>

    <div class="empty-recipes" *ngIf="myRecipes.length === 0">
      <div class="empty-icon">üìù</div>
      <h3 class="empty-title">No recipes yet</h3>
      <p class="empty-description">Start creating your first recipe!</p>
    </div>
  </div>

  <!-- Recipe Form Section -->
  <div class="form-section">
    <div class="form-card">
      <div class="form-header">
        <h2 class="form-title">
          {{ isEditing ? "Edit Your Recipe" : "Create New Recipe" }}
        </h2>
      </div>
      <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="title">Recipe Title</label>
          <input
            id="title"
            formControlName="title"
            type="text"
            placeholder="e.g. Chocolate Cake"
            [class.error]="
              recipeForm.get('title')?.touched &&
              recipeForm.get('title')?.invalid
            "
          />
          <span
            class="error-message"
            *ngIf="
              recipeForm.get('title')?.touched &&
              recipeForm.get('title')?.invalid
            "
          >
            Title is required
          </span>
        </div>

        <div class="form-group">
          <label for="ingredients">Ingredients</label>
          <input
            id="ingredients"
            formControlName="ingredients"
            type="text"
            placeholder="e.g. 1 cup sugar, 3 eggs"
            [class.error]="
              recipeForm.get('ingredients')?.touched &&
              recipeForm.get('ingredients')?.invalid
            "
          />
          <span class="help-text">Separate each ingredient with a comma</span>
          <span
            class="error-message"
            *ngIf="
              recipeForm.get('ingredients')?.touched &&
              recipeForm.get('ingredients')?.invalid
            "
          >
            Ingredients are required
          </span>
        </div>

        <div class="form-group">
          <label for="instructions">Instructions</label>
          <textarea
            id="instructions"
            formControlName="instructions"
            rows="6"
            placeholder="Step by step instructions to make your recipe..."
            [class.error]="
              recipeForm.get('instructions')?.touched &&
              recipeForm.get('instructions')?.invalid
            "
          ></textarea>
          <span
            class="error-message"
            *ngIf="
              recipeForm.get('instructions')?.touched &&
              recipeForm.get('instructions')?.invalid
            "
          >
            Instructions are required
          </span>
        </div>

        <div class="form-actions">
          <button
            class="submit-button"
            type="submit"
            [disabled]="recipeForm.invalid"
          >
            <span class="material-icons">{{
              isEditing ? "check_circle" : "add_circle"
            }}</span>
            {{ isEditing ? "Update Recipe" : "Publish Recipe" }}
          </button>
          <button
            class="cancel-button"
            type="button"
            *ngIf="isEditing"
            (click)="resetForm()"
          >
            <span class="material-icons">close</span>
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
